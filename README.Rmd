---
title: typetracer
output: md_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load injectr, include=FALSE}
devtools::load_all()
```

# typetracer

Trace function parameter types in R packages.

```{r}
library (typetracer)
```


## Example

Define a function, and use [`injectr` code](https://github.com/PRL-PRG) to
inject the `get_types` function used to trace parameter types:

```{r inject}
f <- function (x, y) {
    x * x + y * y
}
code <- body (typetracer:::get_types)
inject_code (code, f)
```

Calls to the function, `f`, will then dump traces to a file in the temporary
directory associated with the R process used to load the `typetracer` package.
This ensures that traces will still work even when called in multi-threaded
processes. The following code shows an example call to the `f` function, and
subsequent extraction of the traces which are dumped to files prefixed with
`typetrace_`. Current demo-only version dumps `storage.type` and `length`.

```{r read-trace}
val <- f (x = 1:2, y = 3:4)
traces <- list.files (tempdir (), pattern = "^typetrace\\_", full.names = TRUE)
print (readLines (traces), width = 20)
```
